# Лабораторная работа 2 - Приложение для построения графиков

Приложение для визуализации математических функций с возможностью синхронизации выбранных графиков между несколькими экземплярами через TCP сокеты.

## Описание

Windows Forms приложение на C#, позволяющее:
- Строить графики математических функций (sin, cos, tan, x², x³, линейные функции)
- Создавать пользовательские графики методом интерполяции IDW (Inverse Distance Weighting)
- Сохранять и загружать пользовательские графики
- Синхронизировать выбранные графики между несколькими запущенными экземплярами приложения через TCP сокеты

## Основные возможности

### Построение графиков
- Визуализация стандартных математических функций
- Создание пользовательских графиков путем добавления точек
- Масштабирование (колесо мыши)
- Перемещение по графику (перетаскивание мышью)
- Настройка цвета графиков
- Настройка фона (сетка, оси координат)

### Синхронизация через сокеты
- Peer-to-peer архитектура: каждое приложение работает как сервер и клиент
- Автоматическая синхронизация выбранных графиков между экземплярами
- Обновление данных каждые 500мс
- Использование TCP сокетов для межпроцессного взаимодействия

## Технологии

- **.NET Framework 4.7.2**
- **Windows Forms**
- **System.Net.Sockets** - для TCP соединений
- **System.Xml.Linq** - для сохранения пользовательских графиков

## Структура проекта

```
laba2/
├── Form1.cs                  # Основная форма приложения
├── Form1.Designer.cs         # Дизайнер формы
├── Form1.Drawing.cs          # Отрисовка графиков
├── GraphSocketManager.cs     # Менеджер синхронизации через сокеты
├── UserGraphsManager.cs      # Менеджер сохранения/загрузки графиков
├── IDWFunction.cs            # Реализация интерполяции IDW
├── IFunction.cs              # Интерфейс для функций
├── Functions.cs              # Стандартные математические функции
├── BackgroundStyle.cs        # Стили фона
├── BackgroundStyleDialog.cs  # Диалог настройки фона
└── Program.cs                # Точка входа
```

## Как работает синхронизация

### Архитектура
1. **Каждый экземпляр запускает TCP-сервер** на уникальном порту (12345-12444)
2. **При запуске** приложение сканирует диапазон портов и ищет другие экземпляры
3. **При обнаружении** других экземпляров запрашивает список выбранных графиков
4. **Таймер каждые 500мс** обновляет локальный список выбранных графиков

### Протокол обмена
```
Клиент → Сервер:  "GET_SELECTED_GRAPHS\n"
Сервер → Клиент:  "SELECTED_GRAPHS_DATA\n"
                 "3\n"                    # Количество графиков
                 "sin(x)\n"               # Имя графика 1
                 "x*x\n"                  # Имя графика 2
                 "tan(x)\n"               # Имя графика 3
```

## Установка и запуск

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd laba2code
```

2. Откройте решение в Visual Studio:
```bash
# Windows
start laba2.sln

# macOS/Linux (через MonoDevelop или Rider)
open laba2.sln
```

3. Соберите проект (F6 или Build → Build Solution)

4. Запустите приложение (F5 или Debug → Start Debugging)

## Использование

### Построение графиков
1. Выберите функции из списка слева (checkbox)
2. Графики отображаются на панели справа
3. Используйте колесо мыши для масштабирования
4. Перетаскивайте график мышью для перемещения
5. Кнопка "Цвет" - изменить цвет графиков
6. Кнопка "Фон" - настроить фон (сетка, оси)

### Создание пользовательского графика
1. Нажмите кнопку "Новый график"
2. Правой кнопкой мыши добавляйте точки на графике
3. Нажмите "Завершить создание" для сохранения

### Синхронизация
1. Запустите несколько экземпляров приложения
2. Выберите графики в одном экземпляре
3. Другие экземпляры автоматически синхронизируют выбранные графики при запуске

## Требования

- Windows с .NET Framework 4.7.2 или выше
- Visual Studio 2017+ (для разработки)

## Особенности реализации

### Многопоточность
- TCP-сервер работает в отдельном потоке
- Клиентские запросы обрабатываются асинхронно через ThreadPool
- Синхронизация защищена блокировками (`lock`)

### Обработка ошибок
- Graceful handling недоступных портов
- Защита от NullReferenceException
- Корректное освобождение ресурсов при закрытии

## Авторы

Проект выполнен в рамках лабораторной работы по курсу программирования.

## Лицензия

Этот проект создан в учебных целях.



